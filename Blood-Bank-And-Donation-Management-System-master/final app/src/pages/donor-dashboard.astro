---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<Layout>
	<Header currentPage="donor" />
	
	<main class="dashboard">
		<div class="container">
			<div class="dashboard-header">
				<h1>Donor Dashboard</h1>
				<p>Register as a blood donor and help save lives in your community</p>
			</div>

			<div class="dashboard-content">
				<div class="form-section">
					<div class="card">
						<h2>Donor Registration</h2>
						<form id="donorForm" class="donor-form">
							<div class="form-row">
								<div class="form-group">
									<label class="form-label" for="firstName">First Name *</label>
									<input type="text" id="firstName" name="firstName" class="form-input" required>
								</div>
								<div class="form-group">
									<label class="form-label" for="lastName">Last Name *</label>
									<input type="text" id="lastName" name="lastName" class="form-input" required>
								</div>
							</div>

							<div class="form-row">
								<div class="form-group">
									<label class="form-label" for="email">Email Address *</label>
									<input type="email" id="email" name="email" class="form-input" required>
								</div>
								<div class="form-group">
									<label class="form-label" for="phone">Phone Number *</label>
									<input type="tel" id="phone" name="phone" class="form-input" required>
								</div>
							</div>

							<div class="form-row">
								<div class="form-group">
									<label class="form-label" for="age">Age *</label>
									<input type="number" id="age" name="age" class="form-input" min="18" max="65" required>
								</div>
								<div class="form-group">
									<label class="form-label" for="weight">Weight (kg) *</label>
									<input type="number" id="weight" name="weight" class="form-input" min="50" required>
								</div>
							</div>

							<div class="form-row">
								<div class="form-group">
									<label class="form-label" for="bloodType">Blood Type *</label>
									<select id="bloodType" name="bloodType" class="form-select" required>
										<option value="">Select Blood Type</option>
										<option value="A+">A+</option>
										<option value="A-">A-</option>
										<option value="B+">B+</option>
										<option value="B-">B-</option>
										<option value="AB+">AB+</option>
										<option value="AB-">AB-</option>
										<option value="O+">O+</option>
										<option value="O-">O-</option>
									</select>
								</div>
								<div class="form-group">
									<label class="form-label" for="gender">Gender *</label>
									<select id="gender" name="gender" class="form-select" required>
										<option value="">Select Gender</option>
										<option value="male">Male</option>
										<option value="female">Female</option>
										<option value="other">Other</option>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="form-label" for="address">Address *</label>
								<textarea id="address" name="address" class="form-input" rows="3" required></textarea>
							</div>

							<div class="form-row">
								<div class="form-group">
									<label class="form-label" for="city">City *</label>
									<input type="text" id="city" name="city" class="form-input" required>
								</div>
								<div class="form-group">
									<label class="form-label" for="state">State *</label>
									<input type="text" id="state" name="state" class="form-input" required>
								</div>
							</div>

							<div class="form-group">
								<label class="form-label" for="lastDonation">Last Donation Date</label>
								<input type="date" id="lastDonation" name="lastDonation" class="form-input">
							</div>

							<div class="form-group">
								<label class="form-label">
									<input type="checkbox" id="availability" name="availability" checked>
									I am currently available to donate blood
								</label>
							</div>

							<div class="form-group">
								<label class="form-label">
									<input type="checkbox" id="emergency" name="emergency">
									Contact me for emergency donations
								</label>
							</div>

							<div class="form-group">
								<label class="form-label">
									<input type="checkbox" id="terms" name="terms" required>
									I agree to the terms and conditions and privacy policy *
								</label>
							</div>

							<button type="submit" class="btn btn-primary btn-full">
								ü©∏ Register as Donor
							</button>
						</form>
					</div>
				</div>

				<div class="info-section">
					<div class="card">
						<h3>Donation Requirements</h3>
						<ul class="requirements-list">
							<li>‚úÖ Age: 18-65 years</li>
							<li>‚úÖ Weight: Minimum 50kg</li>
							<li>‚úÖ Good general health</li>
							<li>‚úÖ No recent illness</li>
							<li>‚úÖ No recent tattoos/piercings</li>
							<li>‚úÖ Not pregnant or breastfeeding</li>
						</ul>
					</div>

					<div class="card">
						<h3>Donation Benefits</h3>
						<ul class="benefits-list">
							<li>ü©∫ Free health checkup</li>
							<li>‚ù§Ô∏è Save up to 3 lives</li>
							<li>üèÜ Community recognition</li>
							<li>üì± Digital donor certificate</li>
							<li>üéÅ Donor rewards program</li>
						</ul>
					</div>

					<div class="card">
						<h3>Next Steps</h3>
						<div class="steps">
							<div class="step-item">
								<span class="step-number">1</span>
								<span>Complete registration</span>
							</div>
							<div class="step-item">
								<span class="step-number">2</span>
								<span>Health screening call</span>
							</div>
							<div class="step-item">
								<span class="step-number">3</span>
								<span>Schedule donation</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<Footer />
</Layout>

<style>
	.dashboard {
		padding: 2rem 0 4rem;
		min-height: 80vh;
	}

	.dashboard-header {
		text-align: center;
		margin-bottom: 3rem;
	}

	.dashboard-header h1 {
		font-size: 2.5rem;
		font-weight: 700;
		color: #1f2937;
		margin-bottom: 0.5rem;
	}

	.dashboard-header p {
		font-size: 1.1rem;
		color: #6b7280;
	}

	.dashboard-content {
		display: grid;
		grid-template-columns: 2fr 1fr;
		gap: 2rem;
	}

	.form-section .card {
		padding: 2.5rem;
	}

	.form-section h2 {
		font-size: 1.5rem;
		font-weight: 600;
		color: #dc2626;
		margin-bottom: 2rem;
	}

	.form-row {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 1rem;
	}

	.btn-full {
		width: 100%;
		font-size: 1.1rem;
		padding: 1rem;
		margin-top: 1rem;
	}

	.info-section {
		display: flex;
		flex-direction: column;
		gap: 1.5rem;
	}

	.info-section .card {
		padding: 1.5rem;
	}

	.info-section h3 {
		font-size: 1.25rem;
		font-weight: 600;
		color: #dc2626;
		margin-bottom: 1rem;
	}

	.requirements-list,
	.benefits-list {
		list-style: none;
		space-y: 0.5rem;
	}

	.requirements-list li,
	.benefits-list li {
		padding: 0.5rem 0;
		color: #374151;
		font-weight: 500;
	}

	.steps {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}

	.step-item {
		display: flex;
		align-items: center;
		gap: 1rem;
	}

	.step-number {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 2rem;
		height: 2rem;
		background: #dc2626;
		color: white;
		border-radius: 50%;
		font-weight: 600;
		font-size: 0.875rem;
	}

	.success-message {
		background: #d1fae5;
		color: #065f46;
		padding: 1rem;
		border-radius: 0.5rem;
		margin-bottom: 1rem;
		display: none;
	}

	.success-message.show {
		display: block;
	}

	@media (max-width: 768px) {
		.dashboard-content {
			grid-template-columns: 1fr;
		}

		.form-row {
			grid-template-columns: 1fr;
		}

		.form-section .card {
			padding: 1.5rem;
		}
	}
</style>

<script>
	document.getElementById('donorForm')?.addEventListener('submit', function(e) {
		e.preventDefault();
		
		const formData = new FormData(this);
		const donorData = Object.fromEntries(formData.entries());
		
		// Get existing donors from localStorage
		const existingDonors = JSON.parse(localStorage.getItem('bloodDonors') || '[]');
		
		// Add new donor with ID and timestamp
		const newDonor = {
			id: Date.now(),
			...donorData,
			registrationDate: new Date().toISOString(),
			status: donorData.availability ? 'Available' : 'Unavailable'
		};
		
		existingDonors.push(newDonor);
		localStorage.setItem('bloodDonors', JSON.stringify(existingDonors));
		
		// Show success message
		const successDiv = document.createElement('div');
		successDiv.className = 'success-message show';
		successDiv.innerHTML = `
			<strong>Registration Successful!</strong><br>
			Thank you ${donorData.firstName} ${donorData.lastName} for registering as a blood donor. 
			You will be contacted within 24 hours for health screening.
		`;
		
		this.insertBefore(successDiv, this.firstChild);
		this.reset();
		
		// Scroll to success message
		successDiv.scrollIntoView({ behavior: 'smooth' });
		
		// Hide success message after 5 seconds
		setTimeout(() => {
			successDiv.remove();
		}, 5000);
	});
</script>